{"version":3,"sources":["file-error.js"],"names":["define","Buffer","files","ErrorCodes","ErrorStrings","FileError","Error","[object Object]","type","message","path","super","this","syscall","errno","code","stack","json","err","buffer","i","fromJSON","JSON","parse","toString","readUInt32LE","p","create","ENOENT","EEXIST","EISDIR","ENOTDIR","EPERM","ENOTEMPTY","alloc","bufferSize","bytesWritten","write","stringify","toJSON","writeUInt32LE","byteLength"],"mappings":";;;;;;;AAAAA,QACI,8BACA,UACA,gBACA,mBACF,SAAUC,EAAOC,EAAMC,EAAWC,GACjC,mBAQOC,UAAkBC,MAWpBC,YAAYC,EAAMC,EAAUL,EAAaI,GAAOE,GAC5CC,MAAMF,GAENG,KAAKC,QAAU,GACfD,KAAKE,MAAQN,EACbI,KAAKG,KAAOZ,EAAWK,GACvBI,KAAKF,KAAOA,EACZE,KAAKI,OAAQ,IAAIV,OAAQU,MACzBJ,KAAKH,kBAAoBG,KAAKG,SAASN,IAAUG,KAAKF,WAAaE,KAAKF,QAAU,KAEtFH,gBAAgBU,GACZ,MAAMC,EAAM,IAAIb,EAAU,GAM1B,OALAa,EAAIJ,MAAQG,EAAKH,MACjBI,EAAIH,KAAOE,EAAKF,KAChBG,EAAIR,KAAOO,EAAKP,KAChBQ,EAAIF,MAAQC,EAAKD,MACjBE,EAAIT,QAAUQ,EAAKR,QACZS,EAKXX,kBAAkBY,EAAQC,EAAI,GAC1B,OAAOf,EAAUgB,SAASC,KAAKC,MAAMJ,EAAOK,SAAS,OAAQJ,EAAI,EAAGA,EAAI,EAAID,EAAOM,aAAaL,MAEpGb,cAAcQ,EAAMW,GAChB,OAAO,IAAIrB,EAAUU,EAAMX,EAAaW,GAAOW,GAEnDnB,cAAcG,GACV,OAAOE,KAAKe,OAAOxB,EAAWyB,OAAQlB,GAE1CH,cAAcG,GACV,OAAOE,KAAKe,OAAOxB,EAAW0B,OAAQnB,GAE1CH,cAAcG,GACV,OAAOE,KAAKe,OAAOxB,EAAW2B,OAAQpB,GAE1CH,eAAeG,GACX,OAAOE,KAAKe,OAAOxB,EAAW4B,QAASrB,GAE3CH,aAAaG,GACT,OAAOE,KAAKe,OAAOxB,EAAW6B,MAAOtB,GAEzCH,iBAAiBG,GACb,OAAOE,KAAKe,OAAOxB,EAAW8B,UAAWvB,GAK7CH,WACI,OAAOK,KAAKH,QAEhBF,SACI,OACIO,MAAOF,KAAKE,MACZC,KAAMH,KAAKG,KACXL,KAAME,KAAKF,KACXM,MAAOJ,KAAKI,MACZP,QAASG,KAAKH,SAMtBF,cAAcY,EAASlB,EAAOiC,MAAMtB,KAAKuB,cAAef,EAAI,GACxD,MAAMgB,EAAejB,EAAOkB,MAAMf,KAAKgB,UAAU1B,KAAK2B,UAAWnB,EAAI,GAErE,OADAD,EAAOqB,cAAcJ,EAAchB,GAC5BD,EAKXZ,aAEI,OAAO,EAAIN,EAAOwC,WAAWnB,KAAKgB,UAAU1B,KAAK2B,YAIzD,OAAOrC,EAAMG,UAAYA","file":"../file-error.js","sourcesContent":["define([\r\n    \"skylark-langx-binary/buffer\",\r\n    \"./files\",\r\n    \"./error-codes\",\r\n    \"./error-strings\"\r\n],function (Buffer,files,ErrorCodes,ErrorStrings) {\r\n   'use strict';\r\n   \r\n\r\n    /* tslint:enable:variable-name */\r\n    /**\r\n     * Represents a BrowserFS error. Passed back to applications after a failed\r\n     * call to the BrowserFS API.\r\n     */\r\n    class FileError extends Error {\r\n        /**\r\n         * Represents a BrowserFS error. Passed back to applications after a failed\r\n         * call to the BrowserFS API.\r\n         *\r\n         * Error codes mirror those returned by regular Unix file operations, which is\r\n         * what Node returns.\r\n         * @constructor FileError\r\n         * @param type The type of the error.\r\n         * @param [message] A descriptive error message.\r\n         */\r\n        constructor(type, message = ErrorStrings[type], path) {\r\n            super(message);\r\n            // Unsupported.\r\n            this.syscall = \"\";\r\n            this.errno = type;\r\n            this.code = ErrorCodes[type];\r\n            this.path = path;\r\n            this.stack = new Error().stack;\r\n            this.message = `Error: ${this.code}: ${message}${this.path ? `, '${this.path}'` : ''}`;\r\n        }\r\n        static fromJSON(json) {\r\n            const err = new FileError(0);\r\n            err.errno = json.errno;\r\n            err.code = json.code;\r\n            err.path = json.path;\r\n            err.stack = json.stack;\r\n            err.message = json.message;\r\n            return err;\r\n        }\r\n        /**\r\n         * Creates an FileError object from a buffer.\r\n         */\r\n        static fromBuffer(buffer, i = 0) {\r\n            return FileError.fromJSON(JSON.parse(buffer.toString('utf8', i + 4, i + 4 + buffer.readUInt32LE(i))));\r\n        }\r\n        static create(code, p) {\r\n            return new FileError(code, ErrorStrings[code], p);\r\n        }\r\n        static ENOENT(path) {\r\n            return this.create(ErrorCodes.ENOENT, path);\r\n        }\r\n        static EEXIST(path) {\r\n            return this.create(ErrorCodes.EEXIST, path);\r\n        }\r\n        static EISDIR(path) {\r\n            return this.create(ErrorCodes.EISDIR, path);\r\n        }\r\n        static ENOTDIR(path) {\r\n            return this.create(ErrorCodes.ENOTDIR, path);\r\n        }\r\n        static EPERM(path) {\r\n            return this.create(ErrorCodes.EPERM, path);\r\n        }\r\n        static ENOTEMPTY(path) {\r\n            return this.create(ErrorCodes.ENOTEMPTY, path);\r\n        }\r\n        /**\r\n         * @return A friendly error message.\r\n         */\r\n        toString() {\r\n            return this.message;\r\n        }\r\n        toJSON() {\r\n            return {\r\n                errno: this.errno,\r\n                code: this.code,\r\n                path: this.path,\r\n                stack: this.stack,\r\n                message: this.message\r\n            };\r\n        }\r\n        /**\r\n         * Writes the API error into a buffer.\r\n         */\r\n        writeToBuffer(buffer = Buffer.alloc(this.bufferSize()), i = 0) {\r\n            const bytesWritten = buffer.write(JSON.stringify(this.toJSON()), i + 4);\r\n            buffer.writeUInt32LE(bytesWritten, i);\r\n            return buffer;\r\n        }\r\n        /**\r\n         * The size of the API error in buffer-form in bytes.\r\n         */\r\n        bufferSize() {\r\n            // 4 bytes for string length.\r\n            return 4 + Buffer.byteLength(JSON.stringify(this.toJSON()));\r\n        }\r\n    }\r\n\r\n    return files.FileError = FileError;\r\n\r\n});"]}