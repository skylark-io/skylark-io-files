{"version":3,"sources":["inodes/dir-inode.js"],"names":["define","paths","Stats","FileType","DirInode","constructor","data","this","_ls","isFile","isDir","getData","getStats","DIRECTORY","getListing","Object","keys","getItem","p","item","addItem","inode","remItem","undefined","isDirInode"],"mappings":";;;;;;;AAAAA,OAAO,CACH,sBACA,WACA,gBACD,SAAUC,EAAOC,EAAMC,GACtB,mBAKMC,EAIFC,YAAYC,EAAO,MACfC,KAAKD,KAAOA,EACZC,KAAKC,IAAM,EACf,CACAC,SACI,MAAO,CAAA,CACX,CACAC,QACI,MAAO,CAAA,CACX,CACAC,UAAY,OAAOJ,KAAKD,IAAM,CAM9BM,WACI,OAAO,IAAIV,EAAMC,EAASU,UAAW,KAAM,GAAK,CACpD,CAMAC,aACI,OAAOC,OAAOC,KAAKT,KAAKC,GAAG,CAC/B,CAKAS,QAAQC,GACEC,EAAOZ,KAAKC,IAAIU,GACtB,OAAOC,GAAc,IACzB,CASAC,QAAQF,EAAGG,GACP,MAAA,EAAIH,KAAKX,KAAKC,MAGdD,KAAKC,IAAIU,GAAKG,EACP,GACX,CAOAC,QAAQJ,GACJ,IAAMC,EAAOZ,KAAKC,IAAIU,GACtB,OAAaK,KAAAA,IAATJ,EACO,MAEX,OAAOZ,KAAKC,IAAIU,GACTC,EACX,CACJ,CAYA,OALAf,EAASoB,WAAc,SAAoBH,GACvC,MAAO,CAAC,CAACA,GAASA,EAAMX,MAAM,CAClC,EAGON,CACX,CAAC","file":"../../inodes/dir-inode.js","sourcesContent":["define([\r\n    \"skylark-langx-paths\",\r\n    '../stats',\r\n    '../file-type'\r\n], function (paths, Stats,FileType) {\r\n    'use strict';\r\n\r\n    /**\r\n     * Inode for a directory. Currently only contains the directory listing.\r\n     */\r\n    class DirInode {\r\n        /**\r\n         * Constructs an inode for a directory.\r\n         */\r\n        constructor(data = null) {\r\n            this.data = data;\r\n            this._ls = {};\r\n        }\r\n        isFile() {\r\n            return false;\r\n        }\r\n        isDir() {\r\n            return true;\r\n        }\r\n        getData() { return this.data; }\r\n        /**\r\n         * Return a Stats object for this inode.\r\n         * @todo Should probably remove this at some point. This isn't the\r\n         *       responsibility of the FileIndex.\r\n         */\r\n        getStats() {\r\n            return new Stats(FileType.DIRECTORY, 4096, 0x16D);\r\n        }\r\n        /**\r\n         * Returns the directory listing for this directory. Paths in the directory are\r\n         * relative to the directory's path.\r\n         * @return The directory listing for this directory.\r\n         */\r\n        getListing() {\r\n            return Object.keys(this._ls);\r\n        }\r\n        /**\r\n         * Returns the inode for the indicated item, or null if it does not exist.\r\n         * @param p Name of item in this directory.\r\n         */\r\n        getItem(p) {\r\n            const item = this._ls[p];\r\n            return item ? item : null;\r\n        }\r\n        /**\r\n         * Add the given item to the directory listing. Note that the given inode is\r\n         * not copied, and will be mutated by the DirInode if it is a DirInode.\r\n         * @param p Item name to add to the directory listing.\r\n         * @param inode The inode for the\r\n         *   item to add to the directory inode.\r\n         * @return True if it was added, false if it already existed.\r\n         */\r\n        addItem(p, inode) {\r\n            if (p in this._ls) {\r\n                return false;\r\n            }\r\n            this._ls[p] = inode;\r\n            return true;\r\n        }\r\n        /**\r\n         * Removes the given item from the directory listing.\r\n         * @param p Name of item to remove from the directory listing.\r\n         * @return Returns the item\r\n         *   removed, or null if the item did not exist.\r\n         */\r\n        remItem(p) {\r\n            const item = this._ls[p];\r\n            if (item === undefined) {\r\n                return null;\r\n            }\r\n            delete this._ls[p];\r\n            return item;\r\n        }\r\n    }\r\n\r\n    /**\r\n\r\n    /**\r\n     * @hidden\r\n     */\r\n    DirInode.isDirInode =  function isDirInode(inode) {\r\n        return !!inode && inode.isDir();\r\n    }\r\n\r\n\r\n    return DirInode;\r\n});"]}